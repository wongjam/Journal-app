{% extends "base.html" %}
{% block title %}{{ t("编辑文件") }} · {{ t("我的心得") }}{% endblock %}

{% block content %}
<div class="container py-4">
  <div class="d-flex flex-wrap gap-2 justify-content-between align-items-end">
    <div>
      <h3 class="mb-1">{{ t("编辑文件") }}</h3>
      <div class="text-muted small"><code>{{ path }}</code></div>
    </div>
    <div class="d-flex gap-2">
      <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('files') }}">{{ t("返回列表") }}</a>
      <a class="btn btn-sm btn-outline-primary"
         href="{{ url_for('file_download') }}?path={{ path|urlencode }}">{{ t("下载") }}</a>
    </div>
  </div>

  <form class="mt-3" method="post" action="{{ url_for('file_edit') }}">
    <!-- ✅ 关键修复：把 path 放进表单 -->
    <input type="hidden" name="path" value="{{ path }}">

    <div class="card shadow-sm">
      <div class="card-body">
        <textarea
          class="form-control font-monospace"
          name="content"
          rows="22"
          spellcheck="false"
        >{{ content }}</textarea>

        <div class="d-flex flex-wrap gap-2 justify-content-between align-items-center mt-3">
          <div class="text-muted small">
            {{ t("提示：保存会直接覆盖原文件。") }}
          </div>
          <div class="d-flex gap-2">
            <button class="btn btn-sm btn-primary" type="submit">{{ t("保存") }}</button>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>
{% endblock %}
